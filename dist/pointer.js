!function(r){var s,u,a,o,i,c,f,l=[],p={onOver:[],onOut:[],onDown:[],onUp:[]},n=window.addEventListener;function e(n){t(n,"onDown")}function t(n,e){if(n.target===r.canvas){-1!==n.type.indexOf("mouse")?(s=5,u=n.clientX,a=n.clientY):(s=10,u=n.touches[0].clientX,a=n.touches[0].clientY);var t={clientX:u,clientY:a,type:n.type,x:u-r.canvas.offsetLeft-s/2,y:a-r.canvas.offsetTop-s/2,size:s},o=[];if(p[e].forEach(function(n){(n.collisionFn||h)(t,n.sprite)&&n.sprite.isAlive&&o.push(n)}),1===o.length)o[0].callback(t);else if(1<o.length){var i,c=-1/0;o.forEach(function(n,e){var t=l.indexOf(n.sprite);c<t&&(c=t,i=e)}),o[i].callback(t)}}}function h(n,e){return n.x<e.x+e.width&&n.x+n.size>e.x&&n.y<e.y+e.height&&n.y+n.size>e.y}n("mousedown",e),n("touchstart",e),n("mousemove",(o=function(n){t(n,"onOver")},i=25,function(){var n=this,e=arguments,t=c&&!f;clearTimeout(f),f=setTimeout(function(){f=null,c||o.apply(n,e)},i),t&&o.apply(n,e)})),r.pointer={},["onOver","onOut","onDown","onUp"].forEach(function(o){r.pointer[o]=function(n,e,t){p[o].push({sprite:n,callback:e,collisionFn:t}),n._render||(n._render=n.render,n.render=function(){l.push(this),this._render()})}}),r._tick=function(){l.length=0}}(kontra);