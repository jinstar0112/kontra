this.kontra={init:function(t){var i=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");this.context=i.getContext("2d")},_noop:new Function,_tick:new Function},kontra.vector=function(t,i){var n=Object.create(kontra.vector.prototype);return n._init(t,i),n},kontra.vector.prototype={_init:function(t,i){this._x=t||0,this._y=i||0},add:function(t,i){this.x+=(t.x||0)*(i||1),this.y+=(t.y||0)*(i||1)},clamp:function(t,i,n,e){this._c=!0,this._a=t,this._b=i,this._d=n,this._e=e},get x(){return this._x},get y(){return this._y},set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t},set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}},kontra.sprite=function(t,i){return(i=Object.create(kontra.sprite.prototype)).init(t),i},kontra.sprite.prototype={init:function(t,i,n,e){for(i in t=t||{},this.position=kontra.vector(t.x,t.y),this.velocity=kontra.vector(t.dx,t.dy),this.acceleration=kontra.vector(t.ddx,t.ddy),this.width=this.height=0,this.context=kontra.context,this.advance=this._a,this.draw=this._c,t)this[i]=t[i];if(n=t.image)this.image=n,this.width=n.width,this.height=n.height,this.draw=this._d;else if(n=t.animations){for(i in n)this.animations[i]=n[i].clone(),e=e||n[i];this._ca=e,this.width=e.width,this.height=e.height,this.advance=this._b,this.draw=this._e}},get x(){return this.position.x},get y(){return this.position.y},get dx(){return this.velocity.x},get dy(){return this.velocity.y},get ddx(){return this.acceleration.x},get ddy(){return this.acceleration.y},set x(t){this.position.x=t},set y(t){this.position.y=t},set dx(t){this.velocity.x=t},set dy(t){this.velocity.y=t},set ddx(t){this.acceleration.x=t},set ddy(t){this.acceleration.y=t},isAlive:function(){return 0<this.ttl},collidesWith:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y},update:function(t){this.advance(t)},render:function(){this.draw()},playAnimation:function(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()},_a:function(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--},_b:function(t){this._a(t),this._ca.update(t)},_c:function(){this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height)},_d:function(){this.context.drawImage(this.image,this.x,this.y)},_e:function(){this._ca.render(this)}},function(){for(var n={},e={},o={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},t=0;t<26;t++)o[65+t]=(10+t).toString(36);for(t=0;t<10;t++)o[48+t]=""+t;addEventListener("keydown",function(t){var i=o[t.which];e[i]=!0,n[i]&&n[i](t)}),addEventListener("keyup",function(t){e[o[t.which]]=!1}),addEventListener("blur",function(t){e={}}),kontra.keys={bind:function(t,i){[].concat(t).map(function(t){n[t]=i})},unbind:function(t,i){[].concat(t).map(function(t){n[t]=i})},pressed:function(t){return!!e[t]}}}(),kontra.gameLoop=function(t){var i,n,e,o,s=(t=t||{}).fps||60,h=0,a=1e3/s,r=1/s,c=!1===t.clearCanvas?kontra._noop:function(){kontra.context.clearRect(0,0,kontra.canvas.width,kontra.canvas.height)};function d(){if(n=requestAnimationFrame(d),e=performance.now(),o=e-i,i=e,!(1e3<o)){for(kontra._tick(),h+=o;a<=h;)u.update(r),h-=a;c(),u.render()}}var u={update:t.update,render:t.render,isStopped:!0,start:function(){i=performance.now(),this.isStopped=!1,requestAnimationFrame(d)},stop:function(){this.isStopped=!0,cancelAnimationFrame(n)}};return u};